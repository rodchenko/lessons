# Занятие 01: Первая программа на Node.js

### Командная строка

Большая часть работы будет происходить в командной строке (Command line interface, CLI, терминал, консоль) – разновидности текстового интерфейса, позволяющем управлять многими системами компьютера и другими программами с помощью текстовых команд.

__Команды обычно строятся по такому принципу:__ `программа --флаг значение_флага -ф параметр`
например: `ls -a -l .` – программа здесь является `ls`, параметром `.` что означает текущую директорию, а двумя короткими флагами будут `-a` и `-l`

_Все принимаемые параметры и синтаксис любой программы можно узнать выполнив, например: `ls --help` или `ls -h`, а также `man ls` – чтобы выведет полное описание программы._


### Список команд, которые нам понадобятся:

- __`cd`__ – дословно "change directory" – позволяет перейти из одной директории (папки) в другую. например `cd websites`  сразу после открытия терминала перенесет вас в папку `~/meteorprojects` если она существует
- __`ls`__ – команда, показывающая список файлов в папке. если выполнить с флагами `ls -alh` то команда покажет все файлы, включая скрытые, в столбик, с размером файлов
- __`pwd`__ – команда, показывающая путь к директории, в которой мы сейчас находимся
- __`open`__ – команда, позволяющая открывать файлы/папки из командной строки. например `open .` откроет finder с той папкой, в которой мы сейчас находимся
- __`CMD + C`__ – сочетание клавиш, которое останавливает выполнение работающей программы
- __`node`__, __`npm`__, __`git`__


### Создание первой программы

1. Создать файл в текстовом редакторе, который называется `app.js`, сохранить его в отдельную папку

2. Поместить в него одну строку `console.log('hello world')`

3. Открыть терминал (программу для ввода текстовых команд)

4. В терминале, перейти в папку, где сохранен файл `app.js`, используя команды `cd`, `ls`, `pwd`.
   Например `cd name_of_direcory`
  
    > _Подсказка: имя папки целиком вводить не обязательно, можно нажать TAB, чтобы сработало автодополнение_
    > _Подсказка: на mac можно перетащить папку в терминал, чтобы получить ее адрес, затем просто дописать `cd ` в начало строки, чтобы в нее перейти_  

5. Находясь в папке с файлом `app.js`, выполнить команду `node app.js`, которая запустит выполнение кода, написанного в файле

6. Проверить результат выполнения программы (:


### Создание простейшего бота

1. Найти сайт, который позволяет взаимодействовать с ним без регистрации. Пример: [Sephs place](https://josephg.com/sp/) – пиксельное панно, копия [/r/place](https://www.reddit.com/r/place/)

2. Зайти на этот сайт в помощью современного браузера (например [chrome](https://www.google.com/chrome/browser/desktop/)) и открыть _developer tools_ в браузере. Проще всего это сделать кликнув правой кнопкой мыши на странице и выбрав пункт `inspect element`

3. Выбрать вкладку, которая показывает команды, которые передает страница. Вкладка называется `Network`

4. Произвести какие-либо действия с сайтом и проверить, какие запросы отправляет сайт во время этих манипуляций

5. Нажать на заинтересовавшие запросы и посмотреть их детали. Запомнить параметры отправляемых запросов: url, method

6. Открыть наш файл `app.js` и создать функцию, которая будет повторять наши действия в браузере. Например:
    ```javascript
    var setPixel = function (x, y, color) {
      var url = 'https://josephg.com/sp/edit?x=' + x + '&y=' + y + '&c=' + color
      console.log(url)
    }
    ```
   - где `setPixel` – это название функции, которое мы придумали
   - `x, y, color` – названия перменных, которые будут принимать параметры функции, например вызов `setPixel(0, 0, 5)` – должен будет поставить красный пиксель в самом левом верхнем углу
   - `url` – название переменной, в которую мы подставляем параметры функции

7. Установить пакет `request` (мини-программу, которую мы сможем применять в своей программе), который будет выполнять запросы к сайту. Для этого выполнить команду в терминале `npm install request` (обязательно внутри папки с `app.js`), которая установит npm-пакет

8. Добавить в саммый верх нашей программы (файл `app.js`) переменную, в которую попадет только что установленный пакет:
    ```javascript
    var request = require('request')
    ```

9. Добавить внутрь функции `setPixel` вызов post-запроса
    ```javascript
    request.post(url, function (error, response) {
      console.log(response.body)
    })
    ```

10. В конечном итоге, наш файл должен выглядеть так:
    ```javascript
    var request = require('request')

    var setPixel = function (x, y, color) {
      // формируем ссылку из параметров функции
      var url = 'https://josephg.com/sp/edit?x=' + x + '&y=' + y + '&c=' + color
      request.post(url, function (error, response) {
        // выводим ответ сервета в консоль
        console.log(response.body)
      })
    }

    // выполняем только что созданную функцию
    setPixel(0, 0, 5)
    ```
11. Теперь мы можем программно наносить пиксели на полотно, меняя параметры передаваемые в функцию `setPixel`, например:
    ```javascript
    // проведет красную линию по диагонали, длиной 100 пикселей
    // с задержкой в 1 секунду между каждым запросом
    for (var i = 0; i < 100; i++) {
      setTimeout(setPixel.bind(null, i, i, 5), 1000 * i)
    }
    ```
